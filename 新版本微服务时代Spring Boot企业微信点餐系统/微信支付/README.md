# 微信支付

## 第三方 SDK

> https://github.com/Pay-Group/best-pay-sdk

## 异步通知

微信会不断进行异步通知，知道系统告知微信订单的处理结果。

1. 验证签名，确认一定时从微信发送的请求。
2. 验证通知中订单支付的状态。
3. 验证通知中订单支付的金额。
4. 验证支付人(支付人 == 下单人)。

## 验证金额相等

**BigDecimal**

`equals`方法比较精度，`0 != 0.00`。

比较时使用`compareTo`方法，不比较精度，`a.compareTo(b) == 0`。

**其他方案**

如果两个`double`值做差，结果`<0.01`，也可以认为金额相等。