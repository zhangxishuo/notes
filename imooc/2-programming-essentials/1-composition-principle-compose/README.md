# 计算机组成原理之组成篇

## 计算机的总线

### 总线的概述

总线解决不同设备之间的通信问题。

![总线](assets/bus.png)

#### 片内总线

高集成度芯片内部的信息传输线。

![片内总线](assets/chip-bus.png)

#### 系统总线

`CPU`、主内存、`IO`设备、各组件之间的信息传输线。

![系统总线](assets/system-bus.png)

- 数据总线：双向传输各个部件的数据信息；数据总线的位数是数据总线的重要参数(一般与`CPU`位数相同)。
- 地址总线：指定源数据或目的数据在内存中的地址；地址总线的位数与存储单元有关；地址总线位数为`n`时，寻址范围为`0~2^n`。
- 控制总线：控制总线是用来发出各种控制信号的传输线；控制信号经由控制总线从一个组件发给另外一个组件；控制总线可以监视不同组件之间的状态(就绪/未就绪)。

### 总线的仲裁

#### 为什么需要仲裁

当多个设备就绪时，都想通过总线交换数据，就会产生冲突。

![仲裁背景](assets/why-arbitrate.png)

仲裁是为了解决总线使用权的冲突问题。

#### 链式查询

- 好处：电路复杂度低，仲裁方式简单。
- 坏处：优先级低的设备难以获得总线使用权。
- 坏处：对电路故障敏感。

![链式查询](assets/chain-query.png)

#### 计时器定时查询

- 仲裁控制器对设备编号并使用计数器累计计数。
- 接收到仲裁信号后，往所有设备发出计数值。
- 计数值与设备编号一致时则获得总线使用权。

![计时器定时查询](assets/timing-query.png)

#### 独立请求

- 每个设备均有总线独立连接仲裁器。
- 设备可单独向仲裁器发送请求和接受请求。
- 当同时收到多个请求信号，仲裁器有权按优先级分配使用权。
- 好处：响应速度快，优先顺序可动态改变。
- 坏处：设备连线多，总线控制复杂。

![独立请求](assets/independent-request.png)